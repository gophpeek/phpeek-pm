version: "1.0"
global:
    shutdown_timeout: 30
    health_check_interval: 10
    restart_policy: always
    max_restart_attempts: 3
    restart_backoff: 5
    restart_backoff_initial: 5s
    restart_backoff_max: 1m0s
    autotune_memory_threshold: 0
    log_format: text
    log_level: info
    log_timestamps: true
    metrics_enabled: false
    metrics_port: 9090
    metrics_path: /metrics
    api_enabled: true
    api_port: 9180
    api_socket: /tmp/phpeek-pm.sock
    api_auth: ""
    api_tls: null
    api_acl: null
    metrics_tls: null
    metrics_acl: null
    resource_metrics_enabled: true
    resource_metrics_interval: 2
    resource_metrics_max_samples: 720
    audit_enabled: false
    tracing_enabled: false
    tracing_exporter: stdout
    tracing_endpoint: ""
    tracing_sample_rate: 1
    tracing_service_name: phpeek-pm
    tracing_use_tls: false
    schedule_history_size: 100
    oneshot_history_max_entries: 5000
    oneshot_history_max_age: 24h0m0s
hooks:
    pre-start: []
    post-start: []
    pre-stop: []
    post-stop: []
processes:
    test-cron:
        enabled: true
        type: oneshot
        initial_state: running
        command:
            - sh
            - -c
            - |
              echo "[CRON $(date '+%H:%M:%S')] Running scheduled task..."
              sleep 2
              echo "[CRON $(date '+%H:%M:%S')] Task completed successfully!"
        working_dir: ""
        stdout: null
        stderr: null
        restart: never
        scale: 1
        max_scale: 1
        depends_on: []
        env: {}
        health_check: null
        shutdown: null
        logging:
            stdout: true
            stderr: true
            labels:
                process: test-cron
                type: scheduled
            min_level: info
            redaction: null
            multiline: null
            json: null
            level_detection: null
            filters: null
        schedule: '* * * * *'
        schedule_timezone: Local
        schedule_timeout: 30s
        schedule_max_concurrent: 1
        heartbeat: null
    test-oneshot:
        enabled: true
        type: oneshot
        initial_state: stopped
        command:
            - sh
            - -c
            - |
              echo "========================================="
              echo "[ONESHOT] Starting one-time task..."
              echo "[ONESHOT] Step 1: Initializing..."
              sleep 1
              echo "[ONESHOT] Step 2: Processing data..."
              sleep 1
              echo "[ONESHOT] Step 3: Finalizing..."
              sleep 1
              echo "[ONESHOT] Task completed successfully!"
              echo "========================================="
        working_dir: ""
        stdout: null
        stderr: null
        restart: never
        scale: 1
        max_scale: 1
        depends_on: []
        env: {}
        health_check: null
        shutdown: null
        logging:
            stdout: true
            stderr: true
            labels:
                process: test-oneshot
                type: oneshot
            min_level: info
            redaction: null
            multiline: null
            json: null
            level_detection: null
            filters: null
        schedule: ""
        schedule_timezone: ""
        heartbeat: null
    test-process-1:
        enabled: true
        type: longrun
        initial_state: running
        command:
            - sleep
            - "3600"
        working_dir: ""
        stdout: null
        stderr: null
        restart: always
        scale: 2
        max_scale: 0
        depends_on: []
        env: {}
        health_check: null
        shutdown: null
        logging:
            stdout: true
            stderr: true
            labels:
                process: test-process-1
            min_level: info
            redaction: null
            multiline: null
            json: null
            level_detection: null
            filters: null
        schedule: ""
        schedule_timezone: ""
        heartbeat: null
    test-process-2:
        enabled: true
        type: longrun
        initial_state: running
        command:
            - sh
            - -c
            - while true; do echo 'Process 2 running'; sleep 5; done
        working_dir: ""
        stdout: null
        stderr: null
        restart: always
        scale: 1
        max_scale: 0
        depends_on: []
        env: {}
        health_check: null
        shutdown: null
        logging:
            stdout: true
            stderr: true
            labels:
                process: test-process-2
            min_level: info
            redaction: null
            multiline: null
            json: null
            level_detection: null
            filters: null
        schedule: ""
        schedule_timezone: ""
        heartbeat: null
    test-queue:
        enabled: true
        type: longrun
        initial_state: running
        command:
            - php
            - artisan
            - queue:work
        working_dir: ""
        stdout: null
        stderr: null
        restart: always
        scale: 2
        max_scale: 0
        depends_on: []
        env: {}
        health_check: null
        shutdown: null
        logging:
            stdout: true
            stderr: true
            labels:
                process: test-queue
            min_level: info
            redaction: null
            multiline: null
            json: null
            level_detection: null
            filters: null
        schedule: ""
        schedule_timezone: ""
        heartbeat: null
